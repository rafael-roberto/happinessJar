<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.icons-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.inline-png-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.inline-svg-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.external-png-1.4.5.css" />
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-material-design.css" />
        <link rel="stylesheet" type="text/css" href="css/ripples.css" />
        <link href="//fezvrasta.github.io/snackbarjs/dist/snackbar.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="css/happinessjar.swatch.css" />
        <title>Happiness Jar</title>

        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
        <script type="text/javascript" src="js/list.js"></script>
        <script type="text/javascript" src="js/list.fuzzysearch.min.js"></script>
        <script type="text/javascript" src="js/list.pagination.js"></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/material.js"></script>
        <script type="text/javascript" src="js/ripples.js"></script>
        <script src="//fezvrasta.github.io/snackbarjs/dist/snackbar.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/noUiSlider/6.2.0/jquery.nouislider.min.js"></script>
        <script type="text/javascript">
            app.initialize();
        </script>
        <script>
            $(function () {
                $.material.init();
                $(".shor").noUiSlider({
                    start: 40,
                    connect: "lower",
                    range: {
                        min: 0,
                        max: 100
                    }
                });

                $(".svert").noUiSlider({
                    orientation: "vertical",
                    start: 40,
                    connect: "lower",
                    range: {
                        min: 0,
                        max: 100
                    }
                });
            });
        </script>

    </head>
    <body>
    <!-- Start of first page -->
    <div data-role="page" id="inicio">

        <div data-role="header">
            <h1>Foo</h1>
        </div><!-- /header -->

        <div role="main" class="ui-content">
            <p>I'm first in the source order so I'm shown as the page.</p>
            <p>View internal page called <a href="#categorias" data-transition="slidedown">bar</a></p>
        </div><!-- /content -->

        <div data-role="footer">
            <h4>Page Footer</h4>
        </div><!-- /footer -->
    </div><!-- /page -->

    <!-- Start of second page -->
    <div data-role="page" id="categorias">

        <div data-role="panel" id="menu">
            <ul data-role="listview">
                <li><a href="#inicio" data-transition="slidedown">Gravar Felicidade</a></li>
                <li class="active">Categorias</li>
            </ul>
        </div>

        <div data-role="header">
            <a href="#inicio" data-transition="slidedown" class="ui-btn ui-icon-home ui-btn-icon-notext ui-corner-all"></a>
            <h1>Categorias</h1>
            <a href="#menu" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all"></a>
        </div><!-- /header -->

        <div role="main" class="ui-content">
            <div data-role="content">
                <div class="label-floating is-empty">
                    <form action="#categorias" id="criarCategoria">
                        <div class="form-group label-floating is-empty">
                            <div class="input-group">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>
                                <label class="control-label" for="searchInput">Pesquisar ou Adicionar Categoria</label>
                                <input id="searchInput" name="categoria" class="form-control search fuzzy-search" type="text" autocomplete="off" value="" onkeypress="return criarNovo(event, value)" onfocus="editandoAnterior()">
                                <p class="help-block">Digite o nome da <code>categoria</code> desejada.</p>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div data-role="content">
                <ul data-role="listview" class="list" id="list-categoria">
                    <li>
                        <p class="name" id="label-1" onclick="editandoLista(1)">Trabalho</p>
                        <div class="jumbotron" id="botoes-1">
                            <div class="form-group label-floating">
                                <input class="form-control name" id="input-1" type="text" value="Trabalho">
                                <p class="help-block">Digite como deve ser o novo nome dessa <code>categoria</code>.</p>
                            </div>
                            <a class="btn btn-primary btn-lg" onclick="editaCategoria(1)"><i class="glyphicon glyphicon-save"></i>&nbspGravar</a>
                            <a class="btn btn-danger btn-lg" onclick="excluiCategoria(1)"><i class="glyphicon glyphicon-trash"></i>&nbspExcluir</a>
                        </div>
                    </li>
                    <li>
                        <p class="name" id="label-2" onclick="editandoLista(2)">Amigos</p>
                        <div class="jumbotron" id="botoes-2">
                            <div class="form-group label-floating">
                                <input class="form-control name" id="input-2" type="text" value="Amigos">
                                <p class="help-block">Digite como deve ser o novo nome dessa <code>categoria</code>.</p>
                            </div>
                            <a class="btn btn-primary btn-lg" onclick="editaCategoria(2)"><i class="glyphicon glyphicon-save"></i>&nbspGravar</a>
                            <a class="btn btn-danger btn-lg" onclick="excluiCategoria(2)"><i class="glyphicon glyphicon-trash"></i>&nbspExcluir</a>
                        </div>
                    </li>
                    <li>
                        <p class="name" id="label-3" onclick="editandoLista(3)">Hobbies</p>
                        <div class="jumbotron" id="botoes-3">
                            <div class="form-group label-floating">
                                <input class="form-control name" id="input-3" type="text" value="Hobbies">
                                <p class="help-block">Digite como deve ser o novo nome dessa <code>categoria</code>.</p>
                            </div>
                            <a class="btn btn-primary btn-lg" onclick="editaCategoria(3)"><i class="glyphicon glyphicon-save"></i>&nbspGravar</a>
                            <a class="btn btn-danger btn-lg" onclick="excluiCategoria(3)"><i class="glyphicon glyphicon-trash"></i>&nbspExcluir</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div><!-- /content -->

        <div data-role="footer" data-position="fixed">
            <h1 id="orderList" class="sort" data-sort="name">
                Ordenar Categorias Pelo Nome
            </h1>
            <h1 id="submitForm" onclick="cadastrarCategoria()" style="display: none" data-transition="slidedown">
                Salvar a Nova Categoria
            </h1>
        </div>
    </div><!-- /page -->

    <script>
        var categoriasList = new List('categorias', {
            valueNames: ['name'],
            page: 10,
            plugins: [ ListFuzzySearch() ]
        });
    </script>
    <script>
        var idAnterior = null;

        function editandoAnterior(){
            if(idAnterior!=null) {
                document.getElementById('botoes-' + idAnterior).style.display = 'none';
                document.getElementById('label-'+idAnterior).style.display='block';
                if(document.getElementById('input-'+idAnterior).value!=document.getElementById('label-'+idAnterior).innerHTML){
                    if(confirm('Deseja atualizar o nome da categoria '+document.getElementById('label-'+idAnterior).innerHTML+' para '+document.getElementById('input-'+idAnterior).value+'?')){
                        document.getElementById('update-'+idAnterior).submit()
                    } else {
                        document.getElementById('input-'+idAnterior).value = document.getElementById('label-'+idAnterior).innerHTML;
                    }
                }
            }
            document.getElementById('submitForm').style.display='none';
            document.getElementById('orderList').style.display='block';
        }

        function editaCategoria(idAnterior){
            if(confirm('Deseja atualizar o nome da categoria '+document.getElementById('label-'+idAnterior).innerHTML+' para '+document.getElementById('input-'+idAnterior).value+'?')){
                alert('A categoria foi atualizada com sucesso!')
            }
        }
        function cadastrarCategoria(){
            if(confirm('Deseja cadastrar a categoria '+ document.getElementById('searchInput').value +'?')==true){
                document.getElementById('create').submit()
            }
        }
        function excluiCategoria(idAnterior){
            if(confirm('Deseja excluir a categoria '+document.getElementById('label-'+idAnterior).innerHTML+'?')){
                if(confirm('Quer excluir todas as felicidades dessa categoria também?')){
                    alert('A categoria '+document.getElementById('label-'+idAnterior).innerHTML+' foi excluída do sistema junto com todas as suas felicidades relacionadas.')
                } else {
                    alert('A categoria '+document.getElementById('label-'+idAnterior).innerHTML+' foi excluída do sistema e suas felicidades ficaram armazenadas sem categoria.')
                }
            }
        }

        function editandoLista(id){
            editandoAnterior()
            document.getElementById('label-'+id).style.display='none';
            document.getElementById('botoes-'+id).style.display='block';
            document.getElementById('input-'+id).focus();
            idAnterior = id;
        }
        function criarNovo(e, texto){
            if (texto.length>=2){
                if (e.keyCode == 13) {
                    cadastrarCategoria();
                }
                document.getElementById('submitForm').style.display='block';
                document.getElementById('orderList').style.display='none';
            } else if (texto.length<2) {
                document.getElementById('submitForm').style.display='none';
                document.getElementById('orderList').style.display='block';
            }
        }
        function hideIcon(self) {
            self.style.backgroundImage = 'none';
        }
    </script>
    <script>
        $(document).ready(function(){
            $("#categoria").addClass("active");
        });
    </script>

    </body>
</html>
