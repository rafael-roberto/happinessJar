<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.icons-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.inline-png-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.inline-svg-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.external-png-1.4.5.css" />
        <link rel="stylesheet" type="text/css" href="css/happinessjar.swatch.css" />
        <title>Happiness Jar</title>

        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
        <script type="text/javascript" src="js/list.js"></script>
        <script type="text/javascript" src="js/list.fuzzysearch.min.js"></script>
        <script type="text/javascript" src="js/list.pagination.js"></script>
        <script type="text/javascript">
            app.initialize();
        </script>

    </head>
    <body>
    <!-- Start of first page -->
    <div data-role="page" id="inicio">

        <div data-role="header">
            <h1>Foo</h1>
        </div><!-- /header -->

        <div role="main" class="ui-content">
            <p>I'm first in the source order so I'm shown as the page.</p>
            <p>View internal page called <a href="#categorias" data-transition="slidedown">bar</a></p>
        </div><!-- /content -->

        <div data-role="footer">
            <h4>Page Footer</h4>
        </div><!-- /footer -->
    </div><!-- /page -->

    <!-- Start of second page -->
    <div data-role="page" id="categorias">

        <div data-role="panel" id="menu">
            <ul data-role="listview">
                <li><a href="#inicio" data-transition="slidedown">Gravar Felicidade</a></li>
                <li class="active">Categorias</li>
            </ul>
        </div>

        <div data-role="header">
            <a href="#inicio" data-transition="slidedown" class="ui-btn ui-icon-home ui-btn-icon-notext ui-corner-all"></a>
            <h1>Categorias</h1>
            <a href="#menu" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all"></a>
        </div><!-- /header -->

        <div role="main" class="ui-content">
            <div data-role="content">
                <div class="inner-addon left-addon">
                    <i class="glyphicon glyphicon-search"></i>
                    <form action="#categorias" id="criarCategoria">
                        <input type="text" id="searchInput" name="categoria" class="form-control search fuzzy-search" required="" autocomplete="off" placeholder="Pesquisar ou Adicionar Categoria" value="" onkeypress="return criarNovo(event, value)" onfocus="editandoAnterior()"/>
                    </form>
                </div>
            </div>
            <div data-role="content">
                <ul data-role="listview" class="list">
                    <li>
                        <p class="name">Trabalho</p>
                    </li>
                    <li>
                        <p class="name">Amigos</p>
                    </li>
                    <li>
                        <p class="name">Hobbies</p>
                    </li>
                </ul>
            </div>
        </div><!-- /content -->

        <div data-role="footer" data-position="fixed">
            <h1 id="orderList" class="sort" data-sort="name">
                Ordenar Categorias Pelo Nome
            </h1>
            <h1 id="submitForm" onclick="document.getElementById('criarCategoria').submit()" style="display: none" data-transition="slidedown">
                Salvar a Nova Categoria
            </h1>
        </div>
    </div><!-- /page -->

    <script>
        var categoriasList = new List('categorias', {
            valueNames: ['name'],
            page: 10,
            plugins: [ ListFuzzySearch() ]
        });
    </script>
    <script>
        var idAnterior = null;

        function editandoAnterior(){
            if(idAnterior!=null) {
                document.getElementById('botoes-' + idAnterior).style.display = 'none';
                document.getElementById('label-'+idAnterior).style.display='block';
                if(document.getElementById('input-'+idAnterior).value!=document.getElementById('label-'+idAnterior).innerHTML){
                    if(confirm('Deseja atualizar o nome da categoria '+document.getElementById('label-'+idAnterior).innerHTML+' para '+document.getElementById('input-'+idAnterior).value+'?')){
                        document.getElementById('update-'+idAnterior).submit()
                    }
                }
            }
            document.getElementById('submitForm').style.display='none';
            document.getElementById('orderList').style.display='block';
        }

        function editandoLista(id){
            editandoAnterior()
            document.getElementById('label-'+id).style.display='none';
            document.getElementById('botoes-'+id).style.display='block';
            document.getElementById('input-'+id).focus();
            idAnterior = id;
        }
        function criarNovo(e, texto){
            //if (e.keyCode == 13) {
            //    if(confirm('Deseja cadastrar a categoria '+ document.getElementById('searchInput').value +'?')==true){
            //        document.getElementById('create').submit()
            //    }
            //}
            if (texto.length>=2){
                document.getElementById('submitForm').style.display='block';
                document.getElementById('orderList').style.display='none';
            } else if (texto.length<2) {
                document.getElementById('submitForm').style.display='none';
                document.getElementById('orderList').style.display='block';
            }
        }
        function hideIcon(self) {
            self.style.backgroundImage = 'none';
        }
    </script>
    <script>
        $(document).ready(function(){
            $("#categoria").addClass("active");
        });
    </script>

    </body>
</html>
